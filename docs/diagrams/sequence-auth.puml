@startuml
title User Authentication & Registration Sequence Diagram

actor User as User
participant "Frontend UI" as Frontend
participant "Backend API" as Backend
participant "AuthManager" as AuthManager
participant "Database" as Database
participant "EmailService" as EmailService

== User Registration Flow ==

group Registration Process
    User -> Frontend: register(name, email, password, role)
    activate Frontend
    
    Frontend -> Backend: POST /api/auth/register
    activate Backend
    
    Backend -> AuthManager: validateRegistrationData()
    activate AuthManager
    AuthManager -> Database: CHECK email_exists WHERE email = ?
    activate Database
    Database --> AuthManager: email_available
    deactivate Database
    AuthManager --> Backend: validation_result
    deactivate AuthManager
    
    Backend -> AuthManager: hashPassword(password)
    activate AuthManager
    AuthManager --> Backend: hashed_password
    deactivate AuthManager
    
    Backend -> Database: INSERT INTO users VALUES (user_data)
    activate Database
    Database --> Backend: user_id
    deactivate Database
    
    Backend -> EmailService: sendVerificationEmail(user_email, token)
    activate EmailService
    EmailService --> Backend: email_sent
    deactivate EmailService
    
    Backend --> Frontend: success: true, message: 'Verification email sent'
    deactivate Backend
    
    Frontend --> User: showRegistrationSuccess()
    deactivate Frontend
end

